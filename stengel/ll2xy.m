function [pt1,pt2] = ll2xy(throttle, roll,pitch,heading,yawdot,airspeed,gspeed, wspeed, altitude,vspeed,volts,amps,mode, comm, engtemp)

angdeg = [ -10 10 -5; -20 20 -10; -10 10 -15; -20 20 -20; -15 15 -30;-10 10 -60; -10 10 -90;  ...
           -30 30 0; ...
           -10 10 5; -20 20 10; -10 10 15; -20 20 20; -15 15 30; -10 10 60; -10 10 90; ];
angdeg(:,1:2) = angdeg(:,1:2)/2;
angrad = angdeg/180*pi;
L0 = 50;
L = 5;
f = 100;

angrad(:,3) = angrad(:,3)+pitch;
pt2 = zeros([3,size(angrad,1)]);
for i= 1: length(angrad)
    R1 = [ cos(angrad(i,1)) 0 -sin(angrad(i,1)); 0 1 0;
          sin(angrad(i,1)) 0 cos(angrad(i,1))];
     pt = R1 * [ 0; 0; L];
        R =  [1 0 0; 0 cos(angrad(i,3)) sin(angrad(i,3)); 0 -sin(angrad(i,3)) cos(angrad(i,3))];
        pt = R*pt;
     pt1(:,i) = pt;
    R2 = [ cos(angrad(i,2)) 0 -sin(angrad(i,2)); 0 1 0;
           sin(angrad(i,2)) 0 cos(angrad(i,2))];
     pt = R2 * [ 0; 0; L];
        pt = R*pt;
     pt2(:,i) = pt;
end

hp=gca;
%set(hp,'DrawMode','fast');
set(hp,'NextPlot','replacechildren');
pt2d1 = pt1(1:2,:)./[(L0 - pt1(3,:)); (L0 - pt1(3,:))].*f;
pt2d2 = pt2(1:2,:)./[(L0 - pt2(3,:));(L0 - pt2(3,:))].*f;
R3 = [cos(roll) sin(roll); -sin(roll) cos(roll)];
pt2d1 = R3*pt2d1; pt2d2 = R3*pt2d2;
th = [0 5 10 15 30 45 60 -5 -10 -15 -30 -45 -60]/180*pi+pi/2;
%axis([-7 7 -7 5.5]);
plot(hp,-4.5,0,'k<',...
    4.5,0,'k>',...
    0,0,'ko',...
    0,-4.50,'kv',...
    0,2.25,'k+',...
    0,-2.25,'k+',...
    -6.,-2.25,'k^',...
    -4.25*cos(roll+pi/2),4.25*sin(roll+pi/2),'ko',...
    5*cos(th(1)),5*sin(th(1)),'g-',...
     5.5*cos(th(1)),5.5*sin(th(1)),'g-','LineWidth',3); 
%set(gcf,'Color','w');
hold on;
text(-1.5708,0,'<==.==>','FontSize',18);
plot(hp, [5*cos(th); 5.5*cos(th)],[5*sin(th); 5.5*sin(th)],'k-','LineWidth',2);
hdgbar = -5:.5:5;
plot(hp,[hdgbar; hdgbar],[-5.5*ones(1,length(hdgbar));-6*ones(1,length(hdgbar))],'k') ;

hang = -10:5:10;
hh = heading/pi*180+hang;
hh(hh>360) = hh(hh>360) - 360;
hh(hh<0) = hh(hh<0) +360;
text(hang/2-0.1,-5.3.*ones(size(hang)),{diag(uint16(hh))},'FontSize',14);

vspdcoord = max(min(vspeed/2.5,5),-5);
%quiver(0,-6.5,max(min(yawdot/pi*5*6,5),-5),0,1,'LineWidth',4,'Color','r')
plot(hp,[6.5;6.5],[0;vspdcoord],'r','LineWidth',4)

CRDS = [6.5, throttle*5;...
    6.25, vspdcoord+sign(vspdcoord)*0.5;...
    0,-6.75;...
    -6.75,.5;...
    -6.75,0;...
    -6.75,-.5;...
    5.,0;...
    6.,6;...
    6,5.25;...
    -6.5,6.;...
    -6.5,5.25;...
    -6.5,4.5];
    
    TSTR = [{sprintf('%03.1f',throttle)};...
        {sprintf('%04.1f',vspeed)};...
    {sprintf('%03d min.',uint16(6/abs(yawdot/pi*180)))};...
    {sprintf('W %02d m/s',uint16(wspeed))};...
    {sprintf('A %02d m/s',uint16(airspeed))};...
    {sprintf('G %02d m/s',uint16(gspeed))};...
    {sprintf('%03d m',uint16(altitude))};...
    {mode};...
    {sprintf('%03d %%',uint16(comm))};...
    {sprintf('%4.1f V',volts)};...
    {sprintf('%03d A',uint16(amps))};...
    {sprintf('%03d ^oC',uint16(engtemp))}];
    
text( CRDS(:,1),CRDS(:,2),TSTR,'FontSize',12);
pp1 = pt2d1(:,angdeg(:,3)>=0); pp2 = pt2d2(:,angdeg(:,3)>=0);
plot(hp,[pp1(1,:); pp2(1,:)],[pp1(2,:); pp2(2,:)],'b','LineWidth',3);
pp1 = pt2d1(:,angdeg(:,3)<0); pp2 = pt2d2(:,angdeg(:,3)<0);
plot(hp,[pp1(1,:); pp2(1,:)],[pp1(2,:); pp2(2,:)],'r','LineWidth',3);
hold off;
axis('off');
